<!DOCTYPE html>
<html>
<head>
<title>TS QUOTEX AI - RISK ENGINE PRO</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{
background:#0a0f1c;
color:white;
font-family:Arial;
text-align:center;
margin:0;
}
.header{
background:linear-gradient(90deg,#00f2ff,#0066ff);
padding:15px;
font-weight:bold;
}
.card{
background:rgba(255,255,255,0.05);
margin:15px;
padding:15px;
border-radius:15px;
box-shadow:0 0 15px rgba(0,255,255,0.3);
}
button{
padding:8px 12px;
border:none;
border-radius:8px;
background:#00bfff;
color:white;
margin:5px;
}
input,select{
padding:8px;
border-radius:8px;
border:none;
margin:5px;
}
.lock{
color:red;
font-weight:bold;
}
</style>
</head>

<body>

<div class="header">TS QUOTEX AI - RISK ENGINE PRO</div>

<div class="card">
<input type="number" id="capital" placeholder="Enter Capital">
<button onclick="setCapital()">Set Capital</button>

<div id="riskInfo"></div>
</div>

<div class="card">
<button onclick="generateSignal()">Generate Signal</button>
<div id="signal"></div>
</div>

<div class="card">
<h3>Trade Result</h3>
<button onclick="markWin()">Win</button>
<button onclick="markLoss()">Loss</button>
<div id="stats"></div>
<div id="lockMsg" class="lock"></div>
</div>

<script>

let capital=0;
let riskPerTrade=0;
let dailyMaxLoss=0;
let totalPnL=0;
let wins=0;
let losses=0;
let locked=false;

function setCapital(){
capital=parseFloat(document.getElementById("capital").value);
if(!capital || capital<=0) return;

riskPerTrade=capital*0.02;
dailyMaxLoss=capital*0.06;

document.getElementById("riskInfo").innerHTML=
"2% Risk Per Trade: $"+riskPerTrade.toFixed(2)+
"<br>Daily Max Loss (6%): $"+dailyMaxLoss.toFixed(2);
}

function generateSignal(){
if(locked){
document.getElementById("signal").innerHTML="Trading Locked For Today";
return;
}

fetch("/api/signal")
.then(res=>res.json())
.then(data=>{
document.getElementById("signal").innerHTML=
data.signal+
"<br>RSI: "+data.rsi+
"<br>EMA9: "+data.emaFast+
"<br>EMA21: "+data.emaSlow;
});
}

function markWin(){
if(locked) return;

totalPnL+=riskPerTrade;
wins++;
updateStats();
}

function markLoss(){
if(locked) return;

totalPnL-=riskPerTrade;
losses++;

if(Math.abs(totalPnL)>=dailyMaxLoss){
locked=true;
document.getElementById("lockMsg").innerHTML="Daily Loss Limit Hit. Trading Locked.";
}

updateStats();
}

function updateStats(){
let totalTrades=wins+losses;
let winrate= totalTrades>0 ? (wins/totalTrades*100).toFixed(1):0;

document.getElementById("stats").innerHTML=
"Total PnL: $"+totalPnL.toFixed(2)+
"<br>Wins: "+wins+
"<br>Losses: "+losses+
"<br>Winrate: "+winrate+"%";
}

</script>

</body>
</html>
